# TFBS Finder Tool

## Overview
The TFBS Finder Tool extracts transcription factor binding sites (TFBS) from DNA sequences in FASTA files using IUPAC consensus sequences. It provides functionalities to process FASTA files, find matches for consensus sequences, and output results in a user-friendly format.

## Installation

To run these scripts, you need Python 3.X and the following libraries installed:

- Biopython
- argparse
- logging
- re
- unittest
- seaborn
- matplotlib

If not installed, you can install the required packages using pip:

```sh
pip install biopython argparse logging re unittest seaborn matplotlib
```

## Usage

Run the tool via the command line:

### Part 1: Identifying TFBS in DNA Sequences
for help run
python part1.py -h or python part2.py -h

for example run
python part1.py <input_fasta> <consensus> [--output_file OUTPUT_FILE] [--delimiter {tab,comma}]

#### Arguments

- input_fasta: Path to the input FASTA file containing DNA sequences.
- consensus: Consensus sequence in IUPAC notation (e.g., GGGRNWYYCC).
- --output_file (optional): Path to the output file for results (default: tfbs_results.txt).
- --delimiter (optional): Delimiter for the output file, either tab (default) or comma.

#### Example
```sh
python part1.py input.fasta GGGRNWYYCC --output_file results.txt --delimiter tab
```

#### Outputs
The output file contains TFBS matches for each sequence:
- Header: Sequence_ID\tTFBS (or comma-delimited)
- Rows: Sequence ID followed by matching TFBS sequences or None if no matches are found.

### Part 2: Analyzing TFBS Results
The part2.py script analyzes the TFBS results generated by part1.py, identifies the most common TFBS sequences, counts sequences without TFBS, and generates a bar plot.

for example run
python part2.py input_file [--output_dir OUTPUT_DIR]

#### Arguments
- input_file (required): Path to the results file generated by part1.py.
- --output_dir (optional): Directory to save output files (default: TFBS_results).

#### Example
```sh
python part2.py results.txt --output_dir TFBS_analysis
```

#### Output
A summary file (TFBS_summary.txt) containing:
- Top 10 most common TFBS sequences with their counts.
- The number of sequences without any TFBS.
- A bar plot (TFBS_plot.png) visualizing the top 10 TFBS sequences.

## Running Tests

### 1. Test Suite for Part 1

File: test_part1.py
To execute:
```sh
python -m unittest test_part1.py
```

Purpose: Verifies functionality for processing FASTA files, validating consensus sequences, and identifying transcription factor binding sites (TFBS).

### 2. Test Suite for Part 2

File: test_part2.py
To execute:
```sh
python -m unittest test_part2.py
```

Purpose: Tests analysis of TFBS output, plotting top TFBS frequencies, saving summaries, and nucleotide counting.